##### ==============================
#####  OH-MY-TMUX (friendly tmux)
##### ==============================

##### --- Core ---
set -g default-terminal "screen-256color"
set -g history-limit 100000
set -sg escape-time 10
set -ga terminal-overrides ",xterm-256color:Tc"

##### --- Prefix (оставляем стандартный C-b) ---
# Если хочешь C-a — раскомментируй блок ниже
# unbind C-b
# set -g prefix C-a
# bind C-a send-prefix

##### --- Mouse ---
# Click panes, resize, scroll, click tabs
set -g mouse on

##### --- Window naming (табов) ---
# Не даём tmux самовольно переименовывать окна
set -g automatic-rename off
set -g allow-rename off

##### --- Splits (удобнее дефолта) ---
unbind '"'
unbind %
bind | split-window -h
bind - split-window -v

##### --- Pane navigation (vim-style) ---
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

##### --- Resize panes quickly ---
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

##### --- Reload config ---
bind r source-file ~/.tmux.conf \; display-message "Reloaded ~/.tmux.conf"

##### --- Copy mode (vi) ---
setw -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

##### ==============================
##### Status bar (IDE-like)
##### ==============================

set -g status-position bottom
set -g status-interval 3
set -g status-style "bg=default"

# Left: session + host
set -g status-left-length 80
set -g status-left "#[bold] #S #[dim]@#H "

# Right: git · load · time
set -g status-right-length 120
set -g status-right "\
#{?pane_in_mode,#[fg=yellow]COPY #[default],}\
#[fg=cyan] #{pane_git_branch} \
#[fg=magenta]󰍛 #{loadavg} \
#[fg=green] %H:%M \
"

# Window tabs
setw -g window-status-separator " "
setw -g window-status-format "  #I:#W  "
setw -g window-status-current-format "#[bold,underline]  #I:#W  #[default]"

##### ==============================
##### Plugins (TPM)
##### ==============================

# Plugin manager
set -g @plugin 'tmux-plugins/tpm'

# Sensible defaults
set -g @plugin 'tmux-plugins/tmux-sensible'

# which-key menus (invoked manually)
set -g @plugin 'alexwforsythe/tmux-which-key'

# Theme
set -g @plugin 'catppuccin/tmux'
set -g @catppuccin_flavour 'mocha'

# Better mouse UX
set -g @plugin 'nhdaly/tmux-better-mouse-mode'

# Session save/restore
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Continuum options
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

##### ==============================
##### which-key entry point
##### ==============================

# Keep defaults intact:
# which-key is opened explicitly to avoid breaking tmux philosophy
bind Space show-wk-menu "#{@wk_menu_root}"

##### ==============================
##### TPM bootstrap (MUST BE LAST)
##### ==============================

run '~/.tmux/plugins/tpm/tpm'

